<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Edward A. Roualdes" />

<meta name="date" content="2016-03-02" />

<title>Predator Preferences Model</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0A%7D%0Apre%20%7B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Predator Preferences Model</h1>
<h4 class="author"><em>Edward A. Roualdes</em></h4>
<h4 class="date"><em>2016-03-02</em></h4>
</div>


<div id="model" class="section level2">
<h2>Model</h2>
<p>Strauss estimates prey preferences using his statistic <span class="math inline">\(L_{st}\)</span> <span class="citation">(Strauss 1979)</span>. <span class="math inline">\(L_{st}\)</span> is the difference between <span class="math inline">\(r_{st}\)</span> the proportion of prey species <span class="math inline">\(s\)</span> found in the gut of a predator during occurrence <span class="math inline">\(t\)</span> and <span class="math inline">\(p_{st}\)</span> the proportion of prey species <span class="math inline">\(s\)</span> found in the habitat of said predator during occurrence <span class="math inline">\(t\)</span>. When the statistic <span class="math inline">\(L_{st} := r_{st} - p_{st}\)</span> is equal to zero we say the predator ate prey species <span class="math inline">\(s\)</span> randomly during time <span class="math inline">\(t\)</span>. A positive difference, <span class="math inline">\(L_{st} &gt; 0\)</span>, indicates preferential eating of prey species <span class="math inline">\(s\)</span>, and negative values indicate aversion to prey species <span class="math inline">\(s\)</span> at time <span class="math inline">\(t\)</span>. We build upon Strauss’s <span class="math inline">\(L\)</span> with the following framework.</p>
<p>Let <span class="math inline">\(X_{jst} \sim \mathcal{P}(\lambda_{st})\)</span> denote the number of prey species <span class="math inline">\(s\)</span> found in the gut of predator <span class="math inline">\(j\)</span> during occurrence <span class="math inline">\(t\)</span>; <span class="math inline">\(j \in \{1, \ldots, J_t\}, s \in \{1, \ldots, S\}, t \in \{1, \ldots, T\}\)</span>. Let <span class="math inline">\(Y_{ist} \sim \mathcal{P}(\gamma_{st})\)</span> will denote the number of prey species <span class="math inline">\(s\)</span> found in trap <span class="math inline">\(i\)</span>, <span class="math inline">\(i \in \{1, \ldots, I_t \}\)</span>, hypothesized to represent the habitat of predator <span class="math inline">\(j\)</span>, during time occurrence <span class="math inline">\(t\)</span>. From the observations <span class="math inline">\(x_{jst}\)</span> and <span class="math inline">\(y_{ist}\)</span> we are able to derive similar conclusions to that of Strauss’s <span class="math inline">\(L\)</span>, but now more efficiently taking into account multiple prey species across an array of time points.</p>
<p>The relative rate with which a predator ate species <span class="math inline">\(s\)</span> during time <span class="math inline">\(t\)</span> to the rate at which prey species <span class="math inline">\(s\)</span> was available in the habitat during time <span class="math inline">\(t\)</span> is represented as the fraction of the respecitve parameters, <span class="math inline">\(c_{st} = \lambda_{st} / \gamma_{st}\)</span>. The quantity <span class="math inline">\(c_{st}\)</span> is then our analogue to Strauss’s statistic <span class="math inline">\(L\)</span>.</p>
<p>We allow <span class="math inline">\(c_{st}\)</span> to naturally vary by prey species, time, neither, or both. We depict these four hypotheses in the following list. Please see our paper <span class="citation">(Roualdes et al. 2016)</span> for further details about the interpretations of these hypotheses.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(c_{st} = c\)</span></li>
<li><span class="math inline">\(c_{st} = c_s\)</span></li>
<li><span class="math inline">\(c_{st} = c_t\)</span></li>
<li><span class="math inline">\(c_{st} = c_{st}\)</span></li>
</ol>
<p>These four cases are built into the null hypothesis <span class="math inline">\(H_0: \boldsymbol{\lambda} = \boldsymbol{c} \boldsymbol{\gamma}\)</span>, where <span class="math inline">\(\boldsymbol{c}\)</span> takes on any of the <span class="math inline">\(1. - 3.\)</span> values of <span class="math inline">\(c_{st}\)</span>. Since the <span class="math inline">\(4\)</span> potential hypotheses are nested, <span class="math inline">\(H_0\)</span> can be contrasted against an alternative that contains the null as a special case. For instance, one could test <span class="math display">\[H_0: \lambda_t = c_t \gamma_t, \forall t \quad \text{ verse } \quad H_1: \lambda_{st} = c_{st} \gamma_{st}.\]</span></p>
<p>A likelihood ratio test statistic <span class="citation">(Wilks 1938)</span> evaluates a given null and alternative hypothesis <span class="math display">\[\Lambda := -2 \log{ \frac{ \sup L(\theta_0|X,Y)}{ \sup L(\theta_1|X,Y)}},\]</span> where <span class="math inline">\(\theta_0, \theta_1\)</span> represent the parameters under the null and alternative hypotheses, respectively. The test statistic <span class="math inline">\(\Lambda \dot{\sim} \chi^2_{\rho}\)</span>, where <span class="math inline">\(\rho\)</span> represent the number of free parameters. The null hypothesis is rejected when <span class="math inline">\(P(\chi^2_{\rho} &gt; \Lambda) &lt; \alpha\)</span>.</p>
</div>
<div id="non-count-gut-data" class="section level2">
<h2>Non-Count Gut Data</h2>
<p>With smaller animals it is not always possible to observe a count of prey species eaten by a predator species. Instead, a binary response of whether or not DNA of said prey species exists in the gut of the predator is observed, via for instance a molecular gut content analysis. In this case, we can treat the count of eaten prey species as missing and maximize the likelihood using an expectation-maximization (EM) algorithm <span class="citation">(Dempster, Laird, and Rubin 1977)</span>.</p>
<p>We model what information we do observe. Denote this binary response by <span class="math inline">\(Z_{jst} = 1(X_{jst} &gt; 0)\)</span>, which takes on the value <span class="math inline">\(1\)</span> if the <span class="math inline">\(j^{th}\)</span> predator ate prey species <span class="math inline">\(s\)</span> in time <span class="math inline">\(t\)</span> and <span class="math inline">\(0\)</span> otherwise. Under this new set up <span class="math inline">\(\Lambda\)</span> is calculated with the observed data likelihood, <span class="math inline">\(L(\theta|Z,Y)\)</span>.</p>
</div>
<div id="spiders-package" class="section level2">
<h2>spiders Package</h2>
<p>Our package assumes two data sets, one for the predators (and what they ate) and one for the caught prey species. Each data set will include a new observation per row; recall that the units of observation for each dataset are different. The column names of both data sets should match. One column, named <code>time</code>, should include the time/date for which each observation was recorded. The other columns should be named for the prey species of interest, e.g.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(Traps)</code></pre></div>
<pre><code>##    time preySpecies1 preySpecies2 preySpecies3 adj
## 1 time1            1            3            3   1
## 2 time1            1            0            1   1
## 3 time1            1            0            1   1
## 4 time1            1            2            1   1
## 5 time1            1            2            0   1
## 6 time1            0            0            2   1</code></pre>
<p>The column <code>adj</code> accounts for unequal trap schedules. Consider the situtation where the traps (catching prey species) were left out for differing lengths of time within occurrence <span class="math inline">\(t\)</span>, e.g. trap <span class="math inline">\(i\)</span> in month <span class="math inline">\(t\)</span> was left out for <span class="math inline">\(6\)</span> days, but trap <span class="math inline">\(i'\)</span> in month <span class="math inline">\(t\)</span> was left out for <span class="math inline">\(3\)</span> days. We expect to catch an unequal number of prey in each trap simply because one trap was left out for a longer time within month <span class="math inline">\(t\)</span>. The user can specify this by creating a column, which has to be named <code>adj</code>, that contains the number of units of time for which each trap was left out.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(Traps)</code></pre></div>
<pre><code>##      time preySpecies1 preySpecies2 preySpecies3 adj
## 930 time5            3            0            0   1
## 931 time5            2            0            1   1
## 932 time5            2            2            0   1
## 933 time5            0            2            2   1
## 934 time5            1            2            3   1
## 935 time5            4            3            0   1</code></pre>
<p>The variable <code>time</code> must be sorted so that summation over occurrences <span class="math inline">\(t\)</span> for both the predators data set and the caught prey species data set will contain an equal number of time periods <span class="math inline">\(T\)</span>, and the <code>time</code>s of such a summed dataframe will match. That is, at least, you should get</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">all.equal</span>(<span class="kw">unique</span>(Traps[,<span class="st">'time'</span>]), <span class="kw">unique</span>(Spiders[,<span class="st">'time'</span>]))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Our package does not check for matching units of time, but it does check for an equal number of units of time across data sets.</p>
<p>Given two dataframes formatted as described above, one representing the predators’ eatings <code>Spiders</code> and one representing the availability of the prey species of interest in the habitat <code>Traps</code>, fit our method by calling</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prefs &lt;-<span class="st"> </span><span class="kw">predPref</span>(Spiders, Traps, <span class="dt">hypotheses=</span><span class="kw">c</span>(<span class="dt">null=</span><span class="st">&quot;C&quot;</span>, <span class="dt">alt=</span><span class="st">&quot;Cst&quot;</span>))</code></pre></div>
<p>An <code>S3</code> summary method is available to summarize, with a user defined significance level, the results of the previous call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(prefs)</code></pre></div>
<pre><code>## 
## Predator Preferences Model:
## 
## Hypotheses:
##  H0 = c 
##  H1 = Cst 
## Likelihood Ratio Test:
##  -2*(llH0-llH1) = 12.04303 on 14 degrees of freedom
##  p-value = 0.6028473 
## Parameter Estimates:
##           estimate Std. Err.
## c_1        0.47554    0.0131
## gamma_1_1  1.13364    0.1186
## gamma_2_1  1.56492    0.0992
## gamma_3_1  1.60188    0.0824
## gamma_4_1  1.47250    0.0686
## gamma_5_1  1.38712    0.0509
## gamma_1_2  1.29383    0.1268
## gamma_2_2  1.36776    0.0926
## gamma_3_2  1.48688    0.0793
## gamma_4_2  1.58956    0.0714
## gamma_5_2  1.50859    0.0533
## gamma_1_3  1.30615    0.1274
## gamma_2_3  1.41705    0.0943
## gamma_3_3  1.42116    0.0774
## gamma_4_3  1.35236    0.0657
## gamma_5_3  1.43641    0.0519</code></pre>
<p>Often with real world data, the alternative hypothesis “Cst” is found to be more likely. In this case, more detail about the predator’s prey preferences is elucidated by calculating linear contrasts of the estimated values <span class="math inline">\(c_{st}\)</span>. Let’s first remind ourselves the dimensions of the estimated vector <span class="math inline">\(\mathbf{c}\)</span> by extracting the elements of this vector <span class="math inline">\(c_{st}\)</span> from the fitted object <code>prefs</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prefs$alt$c</code></pre></div>
<pre><code>## preySpecies11 preySpecies12 preySpecies13 preySpecies14 preySpecies15 
##     0.4153849     0.4853809     0.4181821     0.5078875     0.4021354 
## preySpecies21 preySpecies22 preySpecies23 preySpecies24 preySpecies25 
##     0.5909119     0.5416683     0.5338998     0.4659097     0.5168153 
## preySpecies31 preySpecies32 preySpecies33 preySpecies34 preySpecies35 
##     0.4722228     0.4838717     0.4537820     0.4488453     0.4945064</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(prefs$alt$c)</code></pre></div>
<pre><code>## [1] 15</code></pre>
<p>To calculate a linear contrast we need create a new vector of length equal to the vector <code>prefs$alt$c</code> that will pick out the elements of <span class="math inline">\(\mathbf{c}\)</span> of interest, average, and then contrast the elements against each other – more detail about the intrepretation of linear contrasts in this context is found in <span class="citation">(Roualdes et al. 2016)</span>. For example, if we wanted to compare prey species <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span> across the first two time periods, we would set up the contrast</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">2</span>, <span class="dv">1</span>/<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, -<span class="dv">1</span>/<span class="dv">2</span>, -<span class="dv">1</span>/<span class="dv">2</span>, <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">8</span>))</code></pre></div>
<p>Then use the funciton <code>testC</code> to answer the question, is prey species <span class="math inline">\(1\)</span> within the first two time periods equally preferred to prey species <span class="math inline">\(2\)</span> in those same time periods?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">testC</span>(prefs, b, <span class="dt">sig.level=</span><span class="fl">0.8</span>)</code></pre></div>
<pre><code>## 
##  Linear Contrast: 0.5 0.5 0 0 0 -0.5 -0.5 0 0 0 0 0 0 0 0
## 
## data:  Spiders and Traps
## b^t * C = -0.11591, p-value = 0.2654
## alternative hypothesis: true linear contrast is not equal to 0
## 95 percent confidence interval:
##  -0.31987621  0.08806175
## sample estimates:
##  mean of c_1  mean of c_2  mean of c_3  mean of c_4  mean of c_5 
##    0.4153849    0.4853809    0.4181821    0.5078875    0.4021354 
##  mean of c_6  mean of c_7  mean of c_8  mean of c_9 mean of c_10 
##    0.5909119    0.5416683    0.5338998    0.4659097    0.5168153 
## mean of c_11 mean of c_12 mean of c_13 mean of c_14 mean of c_15 
##    0.4722228    0.4838717    0.4537820    0.4488453    0.4945064</code></pre>
<p>Since the <span class="math inline">\(95\)</span>% confidence interval contains <span class="math inline">\(0\)</span>, we conclude that prey species <span class="math inline">\(1\)</span> and <span class="math inline">\(2\)</span> are equally preferred within the first two time periods. N.B. We specified the significance level with <code>sig.level=0.8</code> to force <code>testC</code> to use the model specified in the alternative hypothesis; this was purely for demonstration of linear contrasts.</p>
</div>
<div id="references" class="section level2 references unnumbered">
<h2>References</h2>
<div id="ref-Dempster:1977">
<p>Dempster, Arthur P, Nan M Laird, and Donald B Rubin. 1977. “Maximum Likelihood from Incomplete Data via the EM Algorithm.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 39 (1). JSTOR: 1–38.</p>
</div>
<div id="ref-Roualdes:2016">
<p>Roualdes, Edward A, Simon J Bonner, Thomas D Whitney, and James D Harwood. 2016. “Formal Modelling of Predator Preferences Using Molecular Gut-Content Analysis.” <em>Environmental and Ecological Statistics</em>.</p>
</div>
<div id="ref-Strauss:1979">
<p>Strauss, Richard E. 1979. “Reliability Estimates for Ivlev’s Electivity Index, the Forage Ratio, and a Proposed Linear Index of Food Selection.” <em>Transactions of the American Fisheries Society</em> 108 (4). Taylor &amp; Francis: 344–52.</p>
</div>
<div id="ref-Wilks:1938">
<p>Wilks, Samuel S. 1938. “The Large-Sample Distribution of the Likelihood Ratio for Testing Composite Hypotheses.” <em>The Annals of Mathematical Statistics</em> 9 (1). JSTOR: 60–62.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
